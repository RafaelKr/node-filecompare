#!/usr/bin/env node

const parseOpts = require('minimist');
const fs = require('fs');
const compare = require('../index.js');
const lib = require('../lib/index.js');

const opts = parseOpts(process.argv.slice(2), {
        alias: { s: 'use-stream', p : 'use-promise' },
        boolean: ['use-stream', 'use-promise'],
        default: { 'use-stream': false, 'use-promise': true }
});
const useStream = opts.s;
const files = opts._;

lib.checkFiles(files,function(err, file1, file2) {
  if (err) {
    console.log(err);
    process.exitCode = 1;
  }

  const type = useStream ? 'streams' : 'promises'; 
  compare({type:type, path1:file1, path2: file2, cb : function(isEqual) {
    console.log("isEqual?",isEqual);
    process.exitCode = 0;
  }});
})
